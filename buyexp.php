<?phpinclude_once("includes/ago.inc.php");include("includes/connect.inc.php");include("header.php");?><?php	/* 			Wersja demonstracyjna przykladowego 		wykorzystania SMS API MicroSMS.pl 		Ostatnia aktualizaja: 2/20/2015		Dowiesz sie tutaj jak wykorzystac API w celu 		- Sprawdzenia kodu SMS z okreslonym numerem SMS (np. wartością doładowania skarbonki)		- Jak zbudowac formularz obierania danych od klienta				Możliwe błedy to 		- E,0 -> brak danych w API		- E,1 -> jeśli nie ma kodu, bądź nie ma 8 znaków		- E,2 -> jeśli użytokwnik bądź usługa nie istnieje bądź nie są w 1 profilu		- E,3 -> Jeśli nie ma numeru SMS		*/	/* 		Jesli Twój skrypt posiada bledy stworzone 		przez programiste, ponizsze polecenia moga wywolac		duza ilosc wpisów na stronie dlatego, zaleca sie 		posiadac wylaczone te opcje, przy niesprawdzonych skryptach		do czasu wyeliminowania problemu.	*/	error_reporting(E_ALL);	ini_set('error_reporting', E_ALL);	ini_set("display_errors", 1);	/*		Zmienna userid pozwala zidentyfikowac partnera MicroSMS		Mozna ja znalezc w panelu administracyjnym od razu po zalogowaniu, pod 		imieniem i nazwiskiem. Np. (ID 1)	*/	$settings['userid'] = 347;	/*		serviceid to numer identyfikacyjny aktywowanej usługi SMS Premium	*/	$settings['serviceid'] = 553;	/* 		Treść wiadomości SMS, na jaką klienci mają wysyłać wiadomości.	*/	$settings['txt'] = 'MSMS.SAMPSHOP';	/*		Numer-y które mają znajdować się w sprzedaży	*/	$microsms[] = array("netto" => 1.00,"number" => 7136,"product" => "100");	$microsms[] = array("netto" => 4.00,"number" => 7455,"product" => "500");	$microsms[] = array("netto" => 7.00,"number" => 77464,"product" => "1000");	$microsms[] = array("netto" => 9.00,"number" => 7936,"product" => "2500");	$microsms[] = array("netto" => 14.00,"number" => 91455,"product" => "5000");	$microsms[] = array("netto" => 19.00,"number" => 91955,"product" => "10000");	$microsms[] = array("netto" => 25.00,"number" => 92555,"product" => "20000");		// I inne w zależności od konfiguracji w panelu partnera	if (isset($_POST['send']) && isset($_POST['code'])) {				$code = addslashes($_POST['code']);				/* 			Weryfikujemy poprawnosc kodu SMS, 			pamietajmy, ze MicroSMS wydaje jedynie			kody posiadajace 8 znaków		*/				if (preg_match("/^[A-Za-z0-9]{8}$/", $code)) {						$a = array();			$b = array();						foreach ($microsms as $cfg) {				array_push($a, $cfg['number']);				$b[$cfg['number']] = $cfg['product'];			}						/* 				Laczymy sie z serwerem MicroSMS w celu				pobrania informacji nt. kodu 			*/			$handle = fopen("http://microsms.pl/api/check_multi.php?userid=" . $settings['userid'] . "&code=" . $code . '&serviceid=' . $settings['serviceid'], 'r');			$check  = fgetcsv($handle, 1024);			fclose($handle);						/* 				Musimy zweryfikowac, czy system przypadkiem 				nie ma bledu i pelen poprawnie formularz dociera				do MicroSMS, jesli na pierwszym tj. 0 miejscu znajduje 				sie odpowiedz E oznacza ERROR i któras zmienna jest				blednie uzupelniona			*/						if ($check[0] != 'E') {								/* 					W przypadku kiedy wszystkie warunki zostaly					spelnione mozemy wydac produkt 				*/								if ($check[0] == 1) {					if (isset($b[$check[2]])) {												$info = '<div class="alert-box" style="  background-color: rgba(45, 255, 0, 0.25);border: 1px solid #00FF2A;"><div>Wszystko przebiegło poprawnie. Kupiłeś </div>'. $b[$check[2]];						// 						// Dalsza czesc Twojego kodu...						//					} else {												$info = '<div class="alert-box" style="background-color: rgba(255, 0, 0, 0.25);border: 1px solid #FF0000;"><div>Numer SMS nie został zainicjowany w skrypcie, skontaktuj sie z administratorem!</div>';					}				} else {										$info = '<div class="alert-box" style="background-color: rgba(255, 0, 0, 0.25);border: 1px solid #FF0000;"><div>Podany kod jest nieprawidłowy!</div></div>';				}			} else {						$info = '<div class="alert-box" style="background-color: rgba(255, 0, 0, 0.25);border: 1px solid #FF0000;"><div>Nieprawidłowo skonfigurowana usługa, skontaktuj sie z administratorem!</div>';			}					} else {						$info = '<div class="alert-box" style="background-color: rgba(255, 0, 0, 0.25);border: 1px solid #FF0000;"><div>Nieprawidlowy format kodu.</div>';					}	}?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pl">   <head>      <meta http-equiv="content-type" content="text/html; charset=utf-8" />      <title>Sklep</title>   </head>   <body>      <style>                  #page { width: 600px; padding: 20px; margin-left: auto; margin-right: auto; border:1px solid #c6c6c6;margin-top: 20px;background: rgba(0, 0, 0, 0.82); }         .center { text-align: center; font-size: 11px; font-family: Tahoma, Arial, Verdana, Helvetica, sans-serif; font-weight: normal;  }         .alert-box { 		   padding: 8px 35px 8px 14px;				color: white;		margin-top: 5px;		 }         .alert-box span { font-weight:bold;text-transform:uppercase; }         .notice { }		 		          .title { font-size: 20px;  font-weight:bold; }         input[type=text], textarea {  padding: 10px;		width: 300px;	  background-color: rgba(0, 0, 0, 0.62);	  color: white;	  margin-top: 8px;	  border: 1px solid rgba(0, 165, 255, 1);         }         .button {         display: block;			border: 1px solid rgba(0, 165, 255, 1);		  padding: 10px;		  width: 250px;		  color: #fff;		  text-transform: uppercase;		  background-color: rgba(0, 129, 255, 0.52);		  margin: 0 auto;		  margin-top: 7;         }         .button:hover {         display: block;			border: 1px solid rgba(0, 165, 255, 1);		  padding: 10px;		  width: 250px;		  color: #fff;		  text-transform: uppercase;		  background-color: rgba(0, 129, 255, 0.85);		  margin: 0 auto;		  margin-top: 7;         }         .button:active {         position:relative;         top:1px;         }         table {         border-collapse: collapse;         width: 100%; }         td {         border: 2px solid #000000;         padding: 5px;}         		.headershop {         font-weight: bold;		          }  		          table#table {         border-collapse: collapse;         width: 100%; }         #table td {         border-width: 1px;         border-style: solid;         border-color: #dddddd;         padding: 5px; }         #table .header {         font-weight: bold; }         #table .emp { }      </style>      <div id="page">         <div class="center">            <table id="table">               <tr class="headershop">                  <td>Cena:</td>                  <td>Numer:</td>				  <td>Treść:</td>                  <td>Produkt:</td>               </tr>               <?php foreach($microsms as $var) { ?>               <tr class="emp">                  <td><?php echo number_format($var['netto'] * ( 1 + 23 / 100 ), 2); ?> z VAT</td>                  <td><?php echo $var['number']; ?></td>				  <td><?php echo $settings['txt']; ?></td>                  <td><?php echo $var['product']; ?> Exp</td>               </tr>               <?php } ?>			</table>           		   <?php if(isset($info)) { ?><div class="alert-box notice"><?php echo $info; ?></div><?php } ?>           		   <form method="post" >               <input type="hidden" name="send" value="" />                  <input name="code" placeholder="Kod sms" type="text" /><br>               <button class="button" type="submit">Sprawdz kod</button>            </form>            <br/>            Płatność zapewnia firma <a href="http://microsms.pl/" color="blue"><font color="blue">MicroSMS</font></a>. <br/>            Regulamin serwisu znajdziesz klikając <a href="http://microsms.pl/partner/documents/"  color="blue"><font color="blue">Tutaj</font></a>.<br/>            Reklamację możesz zgłosić klikając <a href="http://microsms.pl/customer/complaint/" color="blue"><font color="blue">Tutaj</font></a><br/><br/>			<font color="red" font-size: "14px">Nie odpowiadamy za niepoprawnie wysłane SMSy!</font><br/>			<font color="red" font-size: "14px">Po udanym zakupie nie ma możliwości zwrotu pieniędzy!</font><br/><br/>            <img src="http://microsms.pl/public/cms/img/banner.png">         </div>      </div>   </body></html>	<?if(!isset($_COOKIE['sessionID'])) {?><meta http-equiv="refresh" content="0;URL='login.php?nolog'"><?	}	include("footer.php");?>